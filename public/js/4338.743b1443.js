"use strict";(self["webpackChunkdemo1"]=self["webpackChunkdemo1"]||[]).push([[4338],{996:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var s=a(6252),n=a(9963),l=a(3577);const i={class:"d-flex align-items-center position-relative mt-2"},o={class:"svg-icon svg-icon-1 position-absolute ms-6"},r={class:"d-flex pt-3 px-6 w-75","data-kt-subscription-table-toolbar":"base"},c={class:"d-flex justify-content-end","data-kt-subscription-table-toolbar":"base"},u={class:"d-flex my-4"},d={class:"svg-icon svg-icon-2"},m={class:"svg-icon svg-icon-2"},p={class:"text-white text-hover-primary fw-bolder fs-8"},g={class:"symbol-group symbol-hover flex-nowrap flex-grow-1 min-w-100px pe-2"},f=["set"],w={class:"d-flex flex-column w-100 me-2"},v={class:"d-flex flex-stack mb-2"},b={class:"text-muted me-2 fs-7 fw-bold"},h={class:"progress h-6px w-100"},y=["aria-valuenow"],x={class:"text-center pt-2"};function _(e,t,a,_,k,P){const W=(0,s.up)("inline-svg"),A=(0,s.up)("v-autocomplete"),C=(0,s.up)("v-btn"),B=(0,s.up)("router-link"),I=(0,s.up)("v-card-title"),U=(0,s.up)("v-spacer"),V=(0,s.up)("v-tooltip"),R=(0,s.up)("v-icon"),z=(0,s.up)("v-row"),T=(0,s.up)("v-data-table"),j=(0,s.up)("v-pagination"),D=(0,s.up)("v-text-field"),G=(0,s.up)("v-card-text"),E=(0,s.up)("v-card");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{class:"d-flex justify-content-between"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("div",i,[(0,s._)("span",o,[(0,s.Wm)(W,{src:"media/icons/duotune/general/gen021.svg"})]),(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>k.search=e),class:"form-control form-control-solid w-250px ps-15",placeholder:"Rechercher"},null,512),[[n.nr,k.search]])])]),(0,s._)("div",r,[(0,s.Wm)(A,{clearable:"",color:"yellow",modelValue:k.analyse,"onUpdate:modelValue":t[1]||(t[1]=e=>k.analyse=e),items:k.analyses,"item-title":e=>"kt-"+e.id+" Activité : "+e.activite.name+" F*G : "+e.F_G+" Impact Résiduel : "+e.impact_residuel,density:"compact","return-object":"",label:"Environemmentale Analyse Associé",class:"fs-10"},null,8,["modelValue","items","item-title"])]),(0,s._)("div",c,[(0,s._)("div",u,[(0,s.Wm)(C,{onClick:P.exportToExcel,class:"btn btn-sm btn-light me-2",id:"kt_user_follow_button"},{default:(0,s.w5)((()=>[(0,s._)("span",d,[(0,s.Wm)(W,{src:"media/icons/duotune/arrows/arr078.svg"})]),(0,s.Uk)(" Exporter ")])),_:1},8,["onClick"]),(0,s.Wm)(B,{to:"/apps/analyse/add-action",class:"btn btn-sm btn-primary btn-hover-secondary text-hover-dark me-3 pb-0"},{default:(0,s.w5)((()=>[(0,s._)("span",m,[(0,s.Wm)(W,{src:"media/icons/duotune/arrows/arr075.svg"})]),(0,s.Uk)(" Ajouter un Plan d'action ")])),_:1})])])])),_:1}),(0,s.Wm)(U),(0,s.Wm)(G,null,{default:(0,s.w5)((()=>[(0,s.Wm)(T,{page:k.page,"onUpdate:page":t[2]||(t[2]=e=>k.page=e),"items-per-page":k.itemsPerPage,search:k.search,headers:k.headers,items:P.filteredPlanActions,"hide-default-footer":"","show-group-by":"",expanded:""},{["item.analyse_env_id"]:(0,s.w5)((({item:e})=>[(0,s._)("p",p," kt- "+(0,l.zw)(e.columns.analyse_env_id),1)])),["item.responsables"]:(0,s.w5)((({item:t})=>[(0,s._)("div",g,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.columns.responsables,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id},[(0,s.Wm)(V,{text:`${t.name}`},{activator:(0,s.w5)((({props:a})=>[(0,s._)("div",(0,s.dG)({class:"symbol symbol-circle symbol-25px"},e.on),[(0,s._)("div",(0,s.dG)({class:"symbol-label fs-8 fw-bold bg-default text-dark",set:e.name=t.name},a),(0,l.zw)(P.getInitials(e.name)),17,f)],16)])),default:(0,s.w5)((()=>[(0,s._)("span",null,(0,l.zw)(t.name),1)])),_:2},1032,["text"])])))),128))])])),["item.actions"]:(0,s.w5)((({item:e})=>[(0,s.Wm)(z,{class:"text-center d-flex"},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{class:"m-2",to:`/apps/analyse/edit-action-analyse/${e.raw.id}`},{default:(0,s.w5)((()=>[(0,s.Wm)(C,{color:"info",size:"x-small"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-eye")])),_:1})])),_:1})])),_:2},1032,["to"]),(0,s.Wm)(B,{class:"m-2",to:`/apps/analyse/edit-action-analyse/${e.raw.id}`},{default:(0,s.w5)((()=>[(0,s.Wm)(C,{color:"warning",size:"x-small"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-pencil")])),_:1})])),_:1})])),_:2},1032,["to"]),(0,s.Wm)(C,{color:"danger",size:"x-small",onClick:t=>P.deleteItem(e),class:"m-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-delete")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),["item.progress"]:(0,s.w5)((({item:e})=>[(0,s._)("div",w,[(0,s._)("div",v,[(0,s._)("span",b,(0,l.zw)(e.columns.progress)+"% ",1)]),(0,s._)("div",h,[(0,s._)("div",{class:(0,l.C_)(["progress-bar",e.columns.progress<30?"bg-info":e.columns.progress<60?"bg-primary":"bg-success"]),role:"progressbar",style:(0,l.j5)({width:e.columns.progress+"%"}),"aria-valuenow":e.columns.progress,"aria-valuemin":"0","aria-valuemax":"100"},null,14,y)])])])),_:2},1032,["page","items-per-page","search","headers","items"]),(0,s._)("div",x,[(0,s.Wm)(j,{modelValue:k.page,"onUpdate:modelValue":t[3]||(t[3]=e=>k.page=e),length:P.pageCount},null,8,["modelValue","length"]),(0,s.Wm)(D,{class:"d-none",value:k.itemsPerPage,label:"Items per page",type:"number",min:"-1",max:"15",onInput:t[4]||(t[4]=e=>k.itemsPerPage=parseInt(e,10))},null,8,["value"])])])),_:1})])),_:1})])}var k=a(8433),P=a(7677),W=a(2793),A=a(8542),C=a.n(A),B=a(2262),I=a(8932),U=a(7058),V={components:{VDataTable:P.y,VPagination:W.k},computed:{getInitials(){return e=>e.split(" ").map((e=>e.charAt(0))).join("")},filteredPlanActions(){return this.analyse?this.planActions.filter((e=>e.analyse_env_id===this.analyse.id)):this.planActions},currentRouteName(){return window.location.origin},pageCount(){return Math.ceil(this.filteredPlanActions.length/this.itemsPerPage)}},setup(){(0,B.iH)(300);(0,s.bv)((()=>{(0,I.M)("Plans d'action",["Consulter les PA"])}))},data(){return{page:1,itemsPerPage:10,headers:[{title:"Analyse",key:"analyse_env_id"},{title:"Action",value:"name"},{title:"Description",value:"description"},{title:"Progrès",value:"progress",key:"progress"},{title:"Delai",value:"delai"},{title:"Responsables",key:"responsables"},{title:"Actions",key:"actions"}],planActions:[],analyses:[],analyse:null,search:"",initialPlans:[]}},mounted(){this.fetch()},methods:{exportToExcel(){(0,U.G)(this.planActions,"Plans d'action")},setpage(e){this.page=e},previousPage(){this.page>1&&this.page--},nextPage(){this.page<this.pageCount&&this.page++},async deleteItem(e){const t=e.raw.id,a=await C().fire({title:"Êtes-vous sûr(e) ?",text:"Cette action ne peut pas être annulée",icon:"warning",showCancelButton:!0,confirmButtonText:"Oui, supprimer",cancelButtonText:"Annuler",customClass:{confirmButton:"btn fw-bold btn-light-danger",cancelButton:"btn fw-bold btn-light-primary"}});if(a.isConfirmed){await k.Z["delete"](this.currentRouteName+"/api/action/"+t).then((e=>{C().fire({text:"Plan d'action supprimé avec succès",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok",customClass:{confirmButton:"btn fw-bold btn-light-danger"}})})).catch((function(e){C().fire({text:e,icon:"error",buttonsStyling:!1,confirmButtonText:"Réessayer!",customClass:{confirmButton:"btn fw-bold btn-light-danger"}})}));const e=this.filteredPlanActions.findIndex((e=>e.id===t));-1!==e&&this.filteredPlanActions.splice(e,1)}},async fetch(){const e=await k.Z.get(this.currentRouteName+"/api/action");this.initialPlans=e.data,this.planActions=e.data;const t=await k.Z.get(this.currentRouteName+"/api/analyse");this.analyses=t.data}}},R=a(3744);const z=(0,R.Z)(V,[["render",_]]);var T=z}}]);
//# sourceMappingURL=4338.743b1443.js.map